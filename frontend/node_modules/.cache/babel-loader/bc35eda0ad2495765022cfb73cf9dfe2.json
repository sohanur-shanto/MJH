{"ast":null,"code":"import _slicedToArray from\"D:/Laksura_Project/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Button,Row,Col,ListGroup,Image,Card}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import Message from'../components/Message';import{getOrderDetails,payOrder}from'../actions/orderActions';import Loader from'../components/Loader';import{PayPalButton}from'react-paypal-button-v2';import{ORDER_PAY_RESET}from'../constants/orderConstants';import{InlineShareButtons}from'sharethis-reactjs';import dateFormat from'dateformat';import{PDFExport,savePDF}from'@progress/kendo-react-pdf';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OrderScreen(_ref){var match=_ref.match;var pdfExportCompornent=useRef(null);var contentArea=useRef(null);var handleExportWithComponent=function handleExportWithComponent(event){pdfExportCompornent.current.save();};var handleExportWithMethod=function handleExportWithMethod(event){savePDF(contentArea.current,{paperSize:\"A4\"});};var orderId=match.params.id;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),sdkReady=_useState2[0],setSdkReady=_useState2[1];var orderDetails=useSelector(function(state){return state.orderDetails;});var order=orderDetails.order,error=orderDetails.error,loading=orderDetails.loading;var orderPay=useSelector(function(state){return state.orderPay;});var loadingPay=orderPay.loading,successPay=orderPay.success;if(!loading&&!error){order.itemsPrice=order.orderItems.reduce(function(acc,item){return acc+item.price*item.qty;},0).toFixed(2);}var properties={header:'Acme'};var addPayPalScript=function addPayPalScript(){var script=document.createElement('script');script.type='text/javascript';script.src='https://www.paypal.com/sdk/js?client-id=AfMme_xhIk14WIsgDuJXietSKeQyuv3Gb9XU2Mh9tgfwl-jy2KjSa-24bnzHpcxdNg7uL_Tb7apE2ox8';script.async=true;script.onload=function(){setSdkReady(true);};document.body.appendChild(script);};useEffect(function(){if(!order||successPay||order._id!==Number(orderId)){dispatch({type:ORDER_PAY_RESET});dispatch(getOrderDetails(orderId));}else if(!order.isPaid){if(!window.paypal){addPayPalScript();}else{setSdkReady(true);}}},[dispatch,order,orderId,successPay]);var successPaymentHandler=function successPaymentHandler(paymentResult){dispatch(payOrder(orderId,paymentResult));};return loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(\"div\",{className:\"invoicees\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"button-area\",style:{marginTop:30},children:/*#__PURE__*/_jsx(Button,{primary:false,onClick:handleExportWithComponent,children:/*#__PURE__*/_jsx(\"h7\",{children:\"Download Invoice\"})})}),/*#__PURE__*/_jsx(PDFExport,{ref:pdfExportCompornent,paperSize:\"A4\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Col,{style:{marginTop:10,textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:\"https://i2.wp.com/laksura.com.bd/wp-content/uploads/2021/06/main_logo.png?fit=487%2C180&ssl=1\",width:\"150\",height:\"60\"})}),/*#__PURE__*/_jsxs(Row,{style:{marginTop:10,marginBottom:20},children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:1},children:\"Name:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{children:order.user.name})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:1},children:\"Address:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{children:order.shippingAddress.address})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:1},children:\"Mobile:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{children:order.shippingAddress.number})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:1},children:\"Profession:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{children:order.shippingAddress.postalCode})]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:2},children:\"Invoice Number:\"}),\" \",/*#__PURE__*/_jsxs(\"h7\",{children:[\"#\",order._id]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:2},children:\"Order Number:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{children:order._id})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:2},children:\"Order Date:\"}),\" \",/*#__PURE__*/_jsx(\"h7\",{style:{marginRight:2},children:dateFormat(order.createdAt,\"yyyy-mm-dd\")}),\"Time: \",dateFormat(order.createdAt,\"hh:mm:ss\")]})]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{style:{marginRight:5},children:\" Payment Method: \"}),order.paymentMethod]}),order.isPaid?/*#__PURE__*/_jsx(Message,{variant:\"success\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Paid on: \",/*#__PURE__*/_jsx(\"h7\",{style:{marginRight:7,marginLeft:10},children:dateFormat(order.paidAt,\"yyyy-mm-dd\")}),\"Time: \",dateFormat(order.createdAt,\"hh:mm:ss\")]})}):/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Not Paid (Please Pay Soon)\"})})]})})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(\"h5\",{style:{textAlign:'center',marginTop:15,marginBottom:15},children:\"Order Items\"})}),order.orderItems.length===0?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:\"You have no order.\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:order.orderItems.map(function(item,index){return/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true})}),/*#__PURE__*/_jsx(Col,{md:5,children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsxs(\"strong\",{className:\"tk\",children:[\" \",item.qty,\" X Tk \",item.price]}),\" = \",/*#__PURE__*/_jsxs(\"strong\",{className:\"tk\",children:[\"Tk \",(item.qty*item.price).toFixed(2)]})]})]});})})]})]})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(\"h5\",{style:{textAlign:'center',marginTop:15,marginBottom:15},children:\"Order Summary\"}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Subtotal\"}),\" \"]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"strong\",{className:\"tk\",children:[\"Tk \",order.itemsPrice]})})]}),/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Shipping\"}),\" \"]}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(\"strong\",{className:\"tk\",children:[\"Tk \",order.shippingPrice]}),/*#__PURE__*/_jsx(\"small\",{children:\"via Flat rate\"})]})]}),/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"b\",{children:\"Total \"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"strong\",{className:\"tk\",children:[\"Tk \",order.totalPrice,\" \"]})})]}),/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Payment Status\"}),\" \"]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"strong\",{style:{color:'red',textAlign:'center'},children:order.status})})]}),/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Order Status\"}),\" \"]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"strong\",{style:{color:'red',textAlign:'center'},children:order.orderStatus})})]}),/*#__PURE__*/_jsxs(Row,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(Col,{style:{marginBottom:500},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Received By\"}),\" \"]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"strong\",{style:{textAlign:'center'},children:order.received})})]})]})]})})})]})})]});}export default OrderScreen;","map":{"version":3,"sources":["D:/Laksura_Project/backend/frontend/src/screens/OrderScreen.js"],"names":["React","useState","useEffect","useRef","Button","Row","Col","ListGroup","Image","Card","useDispatch","useSelector","Link","Message","getOrderDetails","payOrder","Loader","PayPalButton","ORDER_PAY_RESET","InlineShareButtons","dateFormat","PDFExport","savePDF","OrderScreen","match","pdfExportCompornent","contentArea","handleExportWithComponent","event","current","save","handleExportWithMethod","paperSize","orderId","params","id","dispatch","sdkReady","setSdkReady","orderDetails","state","order","error","loading","orderPay","loadingPay","successPay","success","itemsPrice","orderItems","reduce","acc","item","price","qty","toFixed","properties","header","addPayPalScript","script","document","createElement","type","src","async","onload","body","appendChild","_id","Number","isPaid","window","paypal","successPaymentHandler","paymentResult","marginTop","textAlign","marginBottom","marginRight","user","name","shippingAddress","address","number","postalCode","createdAt","paymentMethod","marginLeft","paidAt","length","map","index","image","product","shippingPrice","totalPrice","color","status","orderStatus","received"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef} from 'react'\r\nimport { Button, Row, Col, ListGroup, Image, Card } from 'react-bootstrap'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { Link } from 'react-router-dom'\r\nimport Message from '../components/Message'\r\nimport { getOrderDetails, payOrder } from '../actions/orderActions'\r\nimport Loader from '../components/Loader'\r\nimport { PayPalButton } from 'react-paypal-button-v2'\r\nimport { ORDER_PAY_RESET } from '../constants/orderConstants'\r\nimport {InlineShareButtons} from 'sharethis-reactjs'\r\nimport dateFormat from 'dateformat'\r\n\r\nimport { PDFExport, savePDF } from '@progress/kendo-react-pdf'\r\n\r\n\r\nfunction OrderScreen({ match }) {\r\n\r\n    const pdfExportCompornent = useRef(null)\r\n    const contentArea = useRef(null)\r\n\r\n    const handleExportWithComponent = (event) => {\r\n        pdfExportCompornent.current.save()\r\n    }\r\n\r\n    const handleExportWithMethod = (event) => {\r\n        savePDF(contentArea.current, { paperSize: \"A4\" })\r\n\r\n    }\r\n\r\n    \r\n\r\n    \r\n\r\n    const orderId = match.params.id\r\n    const dispatch = useDispatch()\r\n\r\n    const [sdkReady, setSdkReady] = useState(false)\r\n\r\n\r\n    const orderDetails = useSelector(state => state.orderDetails)\r\n    const { order, error, loading } = orderDetails\r\n\r\n\r\n    const orderPay = useSelector(state => state.orderPay)\r\n    const { loading:loadingPay, success:successPay } = orderPay\r\n\r\n    if(!loading && !error){\r\n        order.itemsPrice = order.orderItems.reduce((acc, item) => acc + item.price * item.qty, 0).toFixed(2)\r\n    }\r\n\r\n    \r\n  \r\n\r\n    const properties = { header: 'Acme' }\r\n    const addPayPalScript = () => {\r\n        const script = document.createElement('script')\r\n        script.type = 'text/javascript'\r\n        script.src = 'https://www.paypal.com/sdk/js?client-id=AfMme_xhIk14WIsgDuJXietSKeQyuv3Gb9XU2Mh9tgfwl-jy2KjSa-24bnzHpcxdNg7uL_Tb7apE2ox8'\r\n        script.async = true\r\n        script.onload = () => {\r\n            setSdkReady(true)\r\n        }\r\n        document.body.appendChild(script)\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        if(!order || successPay || order._id !== Number(orderId)){\r\n            dispatch({type:ORDER_PAY_RESET})\r\n            dispatch(getOrderDetails(orderId))\r\n        }else if(!order.isPaid){\r\n            if (!window.paypal){\r\n                addPayPalScript()\r\n            }else{\r\n                setSdkReady(true)\r\n            }\r\n        }\r\n    }, [dispatch, order, orderId, successPay])\r\n\r\n    const successPaymentHandler = (paymentResult) => {\r\n        dispatch(payOrder(orderId, paymentResult))\r\n    }\r\n\r\n\r\n\r\n    return loading ? (\r\n        <Loader />\r\n    ) : error ? (\r\n        <Message variant='danger'>{error}</Message>\r\n    ) :  (\r\n       \r\n        \r\n        <div className=\"invoicees\">\r\n            <div className='button-area' style={{ marginTop:30}}>\r\n                                    <Button primary={false} onClick={handleExportWithComponent}><h7>Download Invoice</h7></Button>\r\n                                </div>\r\n        <PDFExport ref={pdfExportCompornent} paperSize=\"A4\">\r\n       \r\n            <Row>\r\n            \r\n                <Col md={12}>\r\n                    <ListGroup variant='flush'>\r\n                        <ListGroup.Item>\r\n                           <Col style={{marginTop:10, textAlign:'center'}}>\r\n                           <img src='https://i2.wp.com/laksura.com.bd/wp-content/uploads/2021/06/main_logo.png?fit=487%2C180&ssl=1'\r\n                            width=\"150\"\r\n                            height=\"60\"\r\n                            ></img>\r\n                        \r\n                            </Col>\r\n\r\n                            <Row style={{marginTop:10, marginBottom:20}}>\r\n                                <Col md={6} >\r\n                                    <ListGroup.Item>\r\n                                        <p><strong style={{marginRight:1}}>Name:</strong> <h7 >{ order.user.name}</h7></p>\r\n                                        <p><strong style={{marginRight:1}}>Address:</strong> <h7 >{ order.shippingAddress.address}</h7></p>\r\n                                        <p><strong style={{marginRight:1}}>Mobile:</strong> <h7 >{order.shippingAddress.number}</h7></p>\r\n                                        <p><strong style={{marginRight:1}}>Profession:</strong> <h7 >{order.shippingAddress.postalCode}</h7></p>\r\n                                    </ListGroup.Item>\r\n                                </Col>\r\n                                <Col md={6}>\r\n                                    <ListGroup.Item>\r\n                                        <p><strong style={{marginRight:2}}>Invoice Number:</strong> <h7 >#{order._id}</h7></p>\r\n                                        <p><strong style={{marginRight:2}}>Order Number:</strong> <h7 >{order._id}</h7></p>\r\n                                        <p><strong style={{marginRight:2}}>Order Date:</strong> <h7 style={{marginRight:2}}>{dateFormat(order.createdAt, \"yyyy-mm-dd\")}</h7>Time: {dateFormat(order.createdAt, \"hh:mm:ss\")}</p>\r\n                                    </ListGroup.Item>\r\n                                </Col>\r\n                            </Row>\r\n                            <Row>\r\n                                <Col>\r\n                                   \r\n                                        <p>\r\n                                            <strong style={{marginRight:5}}> Payment Method: </strong>\r\n                                            {order.paymentMethod}\r\n                                        </p>\r\n\r\n                                        {order.isPaid ? (\r\n                                            <Message variant='success'><p>Paid on: <h7 style={{marginRight:7, marginLeft:10}}>{dateFormat(order.paidAt, \"yyyy-mm-dd\")}</h7>Time: {dateFormat(order.createdAt, \"hh:mm:ss\")}</p></Message>\r\n                                        ) : (\r\n                                            <Message variant='danger'><p>Not Paid (Please Pay Soon)</p></Message>\r\n                                        )}\r\n                                 \r\n                                </Col>\r\n                            </Row>\r\n\r\n                     \r\n                        </ListGroup.Item>\r\n\r\n                        <ListGroup.Item>\r\n                   \r\n                      <Row>\r\n                            <h5 style={{textAlign:'center', marginTop: 15, marginBottom:15}}>Order Items</h5></Row>\r\n                            \r\n                    \r\n                            {order.orderItems.length === 0 ? <Message variant='danger'>\r\n                                You have no order.\r\n                            </Message> : (\r\n                                <ListGroup variant='flush'>\r\n                                    {order.orderItems.map((item, index) => (\r\n                                        \r\n                                            <Row>\r\n                                                <Col md={1}>\r\n                                                    <Image src={item.image} alt={item.name} fluid/>\r\n                                                </Col>\r\n\r\n                                                <Col md={5}>\r\n                                                    <Link to={`/product/${item.product}`}>{item.name}</Link>\r\n                                                </Col>\r\n\r\n                                                <Col md={6}>\r\n                                                <strong className=\"tk\"> {item.qty} X Tk {item.price}</strong> = <strong className=\"tk\">Tk {(item.qty * item.price).toFixed(2)}</strong>\r\n                                                </Col>\r\n                                            </Row>\r\n                                       \r\n                                    ))}\r\n\r\n                                </ListGroup>\r\n                            )}\r\n                        </ListGroup.Item>\r\n\r\n                    </ListGroup>                   \r\n                </Col>\r\n               \r\n                                      \r\n\r\n                <Col >\r\n                    <Card>\r\n                        <ListGroup variant='flush'>\r\n\r\n                        \r\n                           \r\n                                <h5 style={{textAlign:'center', marginTop: 15, marginBottom:15}}>Order Summary</h5>\r\n                             \r\n                           \r\n\r\n                                <ListGroup.Item>\r\n                           \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col><b>Subtotal</b> </Col>\r\n                                    <Col>\r\n                                    <strong className=\"tk\">Tk {order.itemsPrice}</strong>\r\n                                    </Col>\r\n                                </Row>\r\n                            \r\n\r\n\r\n                            \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col><b>Shipping</b> </Col>\r\n                                    <Col>\r\n                                    <strong className=\"tk\">Tk {order.shippingPrice}</strong><small>via Flat rate</small>\r\n                                    </Col>\r\n                                </Row>\r\n                           \r\n\r\n\r\n                            \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col><b>Total </b></Col>\r\n                                    <Col>\r\n                                    <strong className=\"tk\" >Tk {order.totalPrice} </strong>\r\n                                    </Col>\r\n                                </Row>\r\n                            \r\n\r\n                          \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col><b>Payment Status</b> </Col>\r\n                                    <Col>\r\n                                    <strong style={{color:'red', textAlign:'center'}}>{order.status}</strong> \r\n                                    </Col>\r\n                                </Row>\r\n                           \r\n\r\n                             \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col><b>Order Status</b> </Col>\r\n                                    <Col>\r\n                                    <strong style={{color:'red', textAlign:'center'}}>{order.orderStatus}</strong> \r\n                                    </Col>\r\n                                </Row>\r\n                                \r\n                                <Row style={{textAlign:'center'}}>\r\n                                    <Col style={{ marginBottom:500}}><b>Received By</b> </Col>\r\n                                    <Col>\r\n                                    <strong style={{ textAlign:'center'}}>{order.received}</strong> \r\n                                    </Col>\r\n                                </Row>\r\n                                </ListGroup.Item>\r\n                      \r\n\r\n                            {/* {!order.isPaid && (\r\n                                        <ListGroup.Item>\r\n                                            {loadingPay && <Loader />}\r\n\r\n                                            {!sdkReady ? (\r\n                                                <Loader />\r\n                                            ) : (\r\n                                                    <PayPalButton\r\n                                                        amount={order.totalPrice}\r\n                                                        onSuccess={successPaymentHandler}\r\n                                                    />\r\n                                                )}\r\n                                        </ListGroup.Item>\r\n                                    )} */}\r\n                            \r\n                            \r\n                        </ListGroup>       \r\n                    </Card>\r\n                </Col>\r\n                  \r\n            </Row>\r\n            </PDFExport>\r\n          \r\n                 \r\n                                \r\n           \r\n           \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default OrderScreen\r\n"]},"metadata":{},"sourceType":"module"}