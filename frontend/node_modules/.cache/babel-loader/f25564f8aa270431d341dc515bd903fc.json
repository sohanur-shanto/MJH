{"ast":null,"code":"var _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError('Cannot call a class as a function');\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called');\n  }\n\n  return call && (typeof call === 'object' || typeof call === 'function') ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== 'function' && superClass !== null) {\n    throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nvar s = {\n  printRender: 'easy-print-PrintProvider-printRender-S70b',\n  hiddenAll: 'easy-print-PrintProvider-hiddenAll-1V_W',\n  wrap: 'easy-print-PrintProvider-wrap-21G8',\n  _loose: 'easy-print-PrintProvider-_loose-2eYz',\n  _invert: 'easy-print-PrintProvider-_invert-1m-C'\n};\n\nrequire('load-styles')('/*  imported from PrintProvider.css  */\\n\\n@media print {\\n  .easy-print-PrintProvider-printRender-S70b {\\n    width: 100%;\\n    background-color: #fff;\\n    z-index: 10000000;\\n    height: 100vh;\\n    position: absolute;\\n    top: 0;\\n    left: 0\\n  }\\n  .easy-print-PrintProvider-hiddenAll-1V_W {\\n    visibility: hidden ;\\n  }\\n  .easy-print-PrintProvider-hiddenAll-1V_W .react-easy-print-print {\\n    visibility: hidden;\\n  }\\n  .easy-print-PrintProvider-wrap-21G8.easy-print-PrintProvider-_loose-2eYz:not(.easy-print-PrintProvider-_invert-1m-C) {\\n    visibility: hidden;\\n  }\\n}\\n');\n\nimport { spliced, debug } from './common';\nexport var propTypes = {\n  loose: PropTypes.bool,\n  children: PropTypes.node.isRequired,\n  invert: PropTypes.bool\n};\nexport var childContextTypes = {\n  printProvider: PropTypes.shape({\n    regPrintable: PropTypes.func.isRequired,\n    unregPrintable: PropTypes.func.isRequired,\n    isPrint: PropTypes.bool.isRequired\n  }).isRequired\n};\n\nvar PrintProvider = function (_React$PureComponent) {\n  _inherits(PrintProvider, _React$PureComponent);\n\n  function PrintProvider(props) {\n    _classCallCheck(this, PrintProvider);\n\n    var _this = _possibleConstructorReturn(this, (PrintProvider.__proto__ || Object.getPrototypeOf(PrintProvider)).call(this, props));\n\n    _this.state = {\n      isInPrintPreview: false,\n      printableNodes: []\n    };\n    _this.printableRegistry = {};\n\n    window.matchMedia('print').onchange = function () {\n      debug('toggle print mode', window.matchMedia('print').matches);\n\n      _this.setState({\n        isInPrintPreview: window.matchMedia('print').matches\n      });\n    };\n\n    _this.hasSingle = false;\n    return _this;\n  }\n\n  _createClass(PrintProvider, [{\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        printProvider: {\n          isPrint: window.matchMedia('print').matches,\n          regPrintable: this.regPrintable.bind(this),\n          unregPrintable: this.unregPrintable.bind(this)\n        }\n      };\n    } // hideAll - is being used to cover all of React Portals, popups and modals and etc.\n\n  }, {\n    key: 'hideAll',\n    value: function hideAll() {\n      document.body.classList.add(s.hiddenAll);\n      this.hasSingle = true;\n    }\n  }, {\n    key: 'unhideAll',\n    value: function unhideAll() {\n      document.body.classList.remove(s.hiddenAll);\n      this.hasSingle = false;\n    }\n  }, {\n    key: 'regPrintable',\n    value: function regPrintable(key, node) {\n      var _this2 = this;\n\n      var loose = this.props.loose || this.props.invert;\n      var isSingle = node.props.single || node.props.main;\n      var hasSingle = this.hasSingle;\n      debug('reg printable', key, node);\n      if (this.printableRegistry[key] !== undefined || loose) return;\n      setTimeout(function () {\n        return _this2.setState({\n          printableNodes: _this2.state.printableNodes.concat(node)\n        });\n      }, 0);\n      this.printableRegistry[key] = this.state.printableNodes.length;\n\n      if (isSingle && !hasSingle) {\n        this.hideAll();\n      } else if (isSingle) {\n        console.warn(new Error('react-easy-print warning \\n\\t you\\'re using more than one `single` Print component'));\n      }\n    }\n  }, {\n    key: 'unregPrintable',\n    value: function unregPrintable(key, isSingle) {\n      var loose = this.props.loose || this.props.invert;\n      if (this.printableRegistry[key] === undefined || this.state.isInPrintPreview || loose) return;\n      this.setState({\n        printableNodes: spliced(this.state.printableNodes, this.printableRegistry[key])\n      });\n      this.printableRegistry = Object.assign({}, this.printableRegistry, _defineProperty({}, key, undefined));\n\n      if (isSingle) {\n        this.unhideAll();\n      }\n    }\n  }, {\n    key: 'createRender',\n    value: function createRender(children) {\n      var el = document.createElement('div');\n      el.id = 'render';\n      document.body.appendChild(el);\n      ReactDOM.render(React.createElement('div', {\n        className: s.printRender\n      }, children), el);\n    }\n  }, {\n    key: 'deleteRender',\n    value: function deleteRender() {\n      var el = document.getElementById('render');\n      el && document.body.removeChild(el);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _state = this.state,\n          isInPrintPreview = _state.isInPrintPreview,\n          printableNodes = _state.printableNodes;\n      var loose = this.props.loose || this.props.invert;\n      var hasSingle = this.hasSingle;\n\n      if (isInPrintPreview && printableNodes.length && !loose && !hasSingle) {\n        debug('render printable only', printableNodes);\n        var children = React.Children.map(printableNodes, function (child, key) {\n          return React.cloneElement(child, {\n            key: key\n          });\n        });\n        this.createRender(React.createElement('div', null, children));\n      }\n\n      setTimeout(function () {\n        return _this3.deleteRender();\n      }, 0);\n      debug('render everything', isInPrintPreview, printableNodes.length, !loose);\n      var loose_ = loose ? s.loose : '';\n      var invert_ = this.props.invert ? s.invert : '';\n      return React.createElement('div', {\n        className: s.wrap + ' ' + loose_ + ' ' + invert_ + ' '\n      }, this.props.children);\n    }\n  }]);\n\n  return PrintProvider;\n}(React.PureComponent);\n\nexport default PrintProvider;\nPrintProvider.childContextTypes = childContextTypes;","map":{"version":3,"sources":["../../src/PrintProvider.jsx"],"names":["propTypes","loose","PropTypes","children","invert","childContextTypes","printProvider","regPrintable","unregPrintable","isPrint","PrintProvider","React","PureComponent","isInPrintPreview","printableNodes","window","debug","document","s","key","node","isSingle","hasSingle","setTimeout","console","spliced","Object","el","ReactDOM","loose_","invert_"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport s from './PrintProvider.css';\nimport { spliced, debug } from './common';\n\nexport const propTypes = {\n  loose: PropTypes.bool,\n  children: PropTypes.node.isRequired,\n  invert: PropTypes.bool,\n};\n\nexport const childContextTypes = {\n  printProvider: PropTypes.shape({\n    regPrintable: PropTypes.func.isRequired,\n    unregPrintable: PropTypes.func.isRequired,\n    isPrint: PropTypes.bool.isRequired,\n  }).isRequired,\n};\n\nexport default class PrintProvider extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isInPrintPreview: false,\n      printableNodes: [],\n    };\n    this.printableRegistry = {};\n    window.matchMedia('print').onchange = () => {\n      debug('toggle print mode', window.matchMedia('print').matches);\n      this.setState({ isInPrintPreview: window.matchMedia('print').matches });\n    };\n\n    this.hasSingle = false;\n  }\n\n  getChildContext() {\n    return {\n      printProvider: {\n        isPrint: window.matchMedia('print').matches,\n        regPrintable: this.regPrintable.bind(this),\n        unregPrintable: this.unregPrintable.bind(this),\n      },\n    };\n  }\n\n  // hideAll - is being used to cover all of React Portals, popups and modals and etc.\n  hideAll() {\n    document.body.classList.add(s.hiddenAll);\n    this.hasSingle = true;\n  }\n\n  unhideAll() {\n    document.body.classList.remove(s.hiddenAll);\n    this.hasSingle = false;\n  }\n\n  regPrintable(key, node) {\n    const loose = this.props.loose || this.props.invert;\n    const isSingle = node.props.single || node.props.main;\n    const { hasSingle } = this;\n\n    debug('reg printable', key, node);\n\n    if (this.printableRegistry[key] !== undefined || loose) return;\n    setTimeout(() => this.setState({\n      printableNodes: this.state.printableNodes.concat(node),\n    }), 0);\n    this.printableRegistry[key] = this.state.printableNodes.length;\n\n    if (isSingle && !hasSingle) {\n      this.hideAll();\n    }else if(isSingle){\n      console.warn(new Error('react-easy-print warning \\n\\t you\\'re using more than one `single` Print component'));\n    }\n  }\n\n  unregPrintable(key, isSingle) {\n    const loose = this.props.loose || this.props.invert;\n    if (this.printableRegistry[key] === undefined || this.state.isInPrintPreview || loose) return;\n    this.setState({\n      printableNodes: spliced(this.state.printableNodes, this.printableRegistry[key]),\n    });\n    this.printableRegistry = Object.assign({}, this.printableRegistry, { [key]: undefined });\n    if (isSingle) {\n      this.unhideAll();\n    }\n  }\n\n  createRender(children) {\n    const el = document.createElement('div');\n    el.id = 'render';\n    document.body.appendChild(el);\n\n    ReactDOM.render(<div className={s.printRender} >{children}</div>, el);\n  }\n\n  deleteRender() {\n    const el = document.getElementById('render');\n    el && document.body.removeChild(el);\n  }\n\n  render() {\n    const { isInPrintPreview, printableNodes } = this.state;\n    const loose = this.props.loose || this.props.invert;\n    const { hasSingle } = this;\n\n    if (isInPrintPreview && printableNodes.length && !loose && !hasSingle) {\n      debug('render printable only', printableNodes);\n      const children = React.Children.map(printableNodes, (child,key) => {\n        return React.cloneElement(child, { key });\n      });\n\n      this.createRender(<div>{children}</div>);\n    }\n    setTimeout(() => this.deleteRender(), 0);\n\n    debug('render everything', isInPrintPreview, printableNodes.length, !loose);\n    const loose_ = loose ? s.loose : '';\n    const invert_ = this.props.invert ? s.invert : '';\n    return <div className={`${s.wrap} ${loose_} ${invert_} `}>{this.props.children}</div>;\n  }\n}\nPrintProvider.propTypes = propTypes;\nPrintProvider.childContextTypes = childContextTypes;\n"]},"metadata":{},"sourceType":"module"}